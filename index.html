<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome</title>
    <style>
      body {
        font-family: "Georgia", serif;
        margin: 0;
        padding: 0;
        background-color: #ffffff;
        color: #000000;
        overflow-x: hidden;
      }

      section {
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      /* Login section */
      #login {
        background-color: #f5f3f0;
        padding: 20px;
        text-align: center;
      }

      .login-container {
        max-width: 300px;
        margin: 0 auto;
      }

      .login-container input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 5px;
      }

      .login-container button {
        width: 100%;
        padding: 10px;
        background-color: #000000;
        color: #ffffff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      .login-container button:hover {
        background-color: #444444;
      }

      /* Welcome section - keeping white background */
      #welcome {
        background-color: #ffffff;
        display: none; /* Hidden by default */
      }

      .menu-container h1 {
        font-size: 3rem;
        font-weight: normal;
        margin: 0;
        position: absolute;
        top: 10%;
        left: 50%;
        transform: translateX(-50%);
      }

      .menu-container a {
        display: inline-block;
        margin: 10px 0;
        padding: 10px 20px;
        font-size: 1.2rem;
        color: #000000;
        text-decoration: none;
        border: 2px solid #000000;
        border-radius: 5px;
        transition: all 0.3s ease;
      }

      .menu-container a:hover {
        background-color: #000000;
        color: #ffffff;
      }

      /* Age Calculator section - light warm background */
      .age-calculator {
        width: 100%;
        background-color: #f5f3f0;
        text-align: center;
        padding: 20px;
      }

      /* Category Checker section - light cool background */
      .category-checker {
        width: 100%;
        background-color: #d8e4e8;
        text-align: center;
        padding: 20px;
      }

      .age-calculator h2,
      .category-checker h2 {
        font-size: 2rem;
        margin-bottom: 20px;
      }

      form {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .input-group {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 15px;
      }

      .input-group div {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      input,
      select {
        margin: 5px;
        padding: 10px;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 5px;
        width: 200px;
      }

      button {
        margin-top: 10px;
        padding: 10px 20px;
        font-size: 1rem;
        color: #ffffff;
        background-color: #000000;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      button:hover {
        background-color: #444444;
      }

      #result,
      #category-result {
        font-family: "Courier New", monospace;
        font-size: 1.5rem;
      }

      .bold-number {
        font-weight: bold;
      }

      #logoutButton {
        position: absolute;
        top: 20px;
        right: 20px;
        display: none; /* Hidden by default */
      }
    </style>
  </head>
  <body>
    <!-- Login Section -->
    <section id="login">
      <div class="login-container">
        <h2>Login</h2>
        <form id="loginForm">
          <input type="email" id="email" placeholder="Email" required />
          <input type="password" id="password" placeholder="Password" required />
          <button type="submit">Login</button>
        </form>
        <p id="loginError" style="color: red;"></p>
      </div>
    </section>

    <!-- Welcome Section -->
    <section id="welcome">
      <div class="menu-container">
        <h1>Xush kelibsiz, Abbos Nazarovich!</h1>
        <div style="margin-top: 120px">
          <a href="#age-calculator" id="ageCalculatorLink">Bitirish Kalkulyatori</a>
          <a href="#category-checker" id="categoryCheckerLink">Toifa Tekshiruvchisi</a>
        </div>
      </div>
      <button id="logoutButton">Logout</button>
    </section>

    <!-- Age Calculator Section -->
    <section id="age-calculator" class="age-calculator">
      <h2>Bitirish Kalkulyatori</h2>
      <form onsubmit="calculateGraduationAge(event)">
        <div class="input-group">
          <div>
            <label for="dob-date">Boshlanish sanasi</label>
            <input type="date" id="dob-date" required />
          </div>
          <div>
            <label for="grad-date">Tugash sanasi</label>
            <input type="date" id="grad-date" required />
          </div>
        </div>
        <button type="submit">Hisoblash</button>
        <button type="button" onclick="clearFields()">Tozalash</button>
      </form>
      <p id="result"></p>
    </section>

    <!-- Category Checker Section -->
    <section id="category-checker" class="category-checker">
      <h2>Toifa Tekshiruvchisi</h2>
      <br />
      <br />
      <form onsubmit="checkCategory(event)">
        <div class="input-group">
          <div>
            <label for="start-date">Boshlanish sanasi</label>
            <input type="date" id="start-date" required />
          </div>
          <div>
            <label for="end-date">Tugash sanasi</label>
            <input type="date" id="end-date" required />
          </div>
        </div>
        <label for="category">Toifani tanlang</label>
        <select id="category" required>
          <option value="A">Toifa A</option>
          <option value="B">Toifa B</option>
          <option value="C">Toifa C</option>
          <option value="B and C">Toifa B va C</option>
        </select>
        <button type="submit">Tekshirish</button>
        <button type="button" onclick="clearFields()">Tozalash</button>
      </form>
      <p id="category-result"></p>

      <h3>Toifa ma'lumotlari</h3>
      <table
        border="1"
        style="
          margin: 20px auto;
          border-collapse: collapse;
          width: 40%;
          height: 20%;
          text-align: center;
        "
      >
        <thead>
          <tr>
            <th>Toifa</th>
            <th>Talab qilingan kunlar</th>
            <th>Talab qilingan haftalar</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>A</td>
            <td>63 kun</td>
            <td>9 hafta</td>
          </tr>
          <tr>
            <td>B</td>
            <td>126 kun</td>
            <td>18 hafta</td>
          </tr>
          <tr>
            <td>C</td>
            <td>154 kun</td>
            <td>22 hafta</td>
          </tr>
          <tr>
            <td>B va C</td>
            <td>168 kun</td>
            <td>24 hafta</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Firebase and Custom Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyCIShLaGint52snMfp6txUDLH3-qqbvJxA",
        authDomain: "test-abbos.firebaseapp.com",
        projectId: "test-abbos",
        storageBucket: "test-abbos.appspot.com",
        messagingSenderId: "878512105415",
        appId: "1:878512105415:web:4e574b43087f2ab8349be2",
        measurementId: "G-QFN9JGXF9E",
      };

      // Initialize Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();

      // Login functionality
      document.getElementById("loginForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        auth
          .signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // Login successful
            const user = userCredential.user;
            console.log("Logged in as:", user.email);
            document.getElementById("loginError").textContent = ""; // Clear error message
            // Hide login form and show main content
            document.getElementById("login").style.display = "none";
            document.getElementById("welcome").style.display = "block";
            document.getElementById("logoutButton").style.display = "block";
          })
          .catch((error) => {
            // Handle errors
            const errorMessage = error.message;
            document.getElementById("loginError").textContent = errorMessage;
          });
      });

      // Logout functionality
      document.getElementById("logoutButton").addEventListener("click", () => {
        auth.signOut().then(() => {
          console.log("User signed out");
          // Show login form and hide main content
          document.getElementById("login").style.display = "block";
          document.getElementById("welcome").style.display = "none";
          document.getElementById("logoutButton").style.display = "none";
        });
      });

      // Check authentication state
      auth.onAuthStateChanged((user) => {
        if (user) {
          // User is logged in
          console.log("User is logged in:", user.email);
          document.getElementById("login").style.display = "none";
          document.getElementById("welcome").style.display = "block";
          document.getElementById("logoutButton").style.display = "block";
        } else {
          // User is not logged in
          console.log("User is not logged in");
          document.getElementById("login").style.display = "block";
          document.getElementById("welcome").style.display = "none";
          document.getElementById("logoutButton").style.display = "none";
        }
      });

      // Existing functions (unchanged)
      function clearFields() {
        document.getElementById("start-date").value = "";
        document.getElementById("end-date").value = "";
        document.getElementById("dob-date").value = "";
        document.getElementById("grad-date").value = "";
      }

      // Smooth Scroll Function
      document
        .getElementById("ageCalculatorLink")
        .addEventListener("click", function (event) {
          event.preventDefault();
          const target = document.getElementById("age-calculator");

          window.scrollTo({
            top: target.offsetTop,
            behavior: "smooth",
          });
        });

      document
        .getElementById("categoryCheckerLink")
        .addEventListener("click", function (event) {
          event.preventDefault();
          const target = document.getElementById("category-checker");

          window.scrollTo({
            top: target.offsetTop,
            behavior: "smooth",
          });
        });

      function calculateGraduationAge(event) {
        event.preventDefault();

        const dob = new Date(document.getElementById("dob-date").value);
        const gradDate = new Date(document.getElementById("grad-date").value);

        if (dob > gradDate) {
          document.getElementById("result").innerHTML =
            "Bitirish sanasi tug'ilgan sanadan oldin bo'lishi mumkin emas!";
          return;
        }

        let ageYears = gradDate.getFullYear() - dob.getFullYear();
        let ageMonths = gradDate.getMonth() - dob.getMonth();

        if (ageMonths < 0) {
          ageYears--;
          ageMonths += 12;
        }

        document.getElementById(
          "result"
        ).innerHTML = `Siz bitirganingizda <span class="bold-number">${ageYears}</span> yosh va <span class="bold-number">${ageMonths}</span> oylik edingiz.`;
      }

      function checkCategory(event) {
        event.preventDefault();

        const startDate = new Date(document.getElementById("start-date").value);
        const endDate = new Date(document.getElementById("end-date").value);
        const category = document.getElementById("category").value;

        if (startDate > endDate) {
          document.getElementById("category-result").innerHTML =
            "Tugash sanasi boshlanish sanasidan oldin bo'lishi mumkin emas!";
          return;
        }

        const daysStudied = (endDate - startDate) / (1000 * 60 * 60 * 24);
        const weeksStudied = (daysStudied / 7).toFixed(2);

        let isValid = false;
        let daysNeed = 0;
        let weeksNeed = 0;

        switch (category) {
          case "A":
            isValid = daysStudied >= 63 || weeksStudied >= 9;
            daysNeed = 63;
            weeksNeed = 9;
            break;
          case "B":
            isValid = daysStudied >= 126 || weeksStudied >= 18;
            daysNeed = 126;
            weeksNeed = 18;
            break;
          case "C":
            isValid = daysStudied >= 154 || weeksStudied >= 22;
            daysNeed = 154;
            weeksNeed = 22;
            break;
          case "B and C":
            isValid = daysStudied >= 168 || weeksStudied >= 24;
            daysNeed = 168;
            weeksNeed = 24;
            break;
        }

        if (isValid) {
          document.getElementById(
            "category-result"
          ).innerHTML = `Tabriklaymiz! Siz <span class="bold-number">${category}</span> toifa talablariga javob berasiz. 
                        <br><br>Siz <span class="bold-number">${weeksStudied} hafta</span> yoki <span class="bold-number">${daysStudied} kun</span> o'qidingiz. 
                        <br><span class="bold-number">${category}</span> toifani yakunlash uchun <span class="bold-number">${weeksNeed} hafta</span> yoki <span class="bold-number">${daysNeed} kun</span> talab qilinadi.`;
        } else {
          document.getElementById(
            "category-result"
          ).innerHTML = `Afsuski, siz <span class="bold-number">${category}</span> toifa talablariga javob bermaysiz.
                        <br><br>Siz <span class="bold-number">${weeksStudied} hafta</span> yoki <span class="bold-number">${daysStudied} kun</span> o'qidingiz. 
                        <br><span class="bold-number">${category}</span> toifani yakunlash uchun <span class="bold-number">${weeksNeed} hafta</span> yoki <span class="bold-number">${daysNeed} kun</span> talab qilinadi.`;
        }
      }
    </script>
  </body>
</html>
